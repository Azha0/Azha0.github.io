<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Azha0's Space</title><meta name="description" content="键盘敲烂，月薪过万!"><meta name="author" content="Azha0,A_zha0@163.com"><meta name="copyright" content="Azha0"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/favicon.png"><link rel="canonical" href="http://example.com/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="website"><meta property="og:title" content="Azha0's Space"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Azha0's Space"><meta property="og:description" content="键盘敲烂，月薪过万!"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/avatar.png"><meta property="article:published_time" content="2020-09-13T17:27:06.062Z"><meta property="article:modified_time" content="2020-09-13T17:27:06.062Z"><meta name="twitter:card" content="summary"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime: '天',
  date_suffix: {"one_hour":"刚刚","hours":"小时前","day":"天前"},
  copyright: {"limitCount":50,"languages":{"author":"作者: Azha0","link":"链接: ","source":"来源: Azha0's Space","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
    },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: undefined,
  isSidebar: false,
  postUpdate: '2020-09-14 01:27:06'
}</script><noscript><style type="text/css">
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
  }
}

var autoChangeMode = '1'
var t = saveToLocal.get('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (saveToLocal.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><meta name="generator" content="Hexo 5.1.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/avatar.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">13</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">21</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div id="body-wrap"><header class="full_page" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/homepage.jpg-slim)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Azha0's Space</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="site-info"><h1 id="site_title">Azha0's Space</h1><div id="site_subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/Azha0" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:A_zha0@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll_down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout_page" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/09/12/hello-world/" title="Hello World">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/homepage.jpg-slim" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="Hello World"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/09/12/hello-world/" title="Hello World">Hello World</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-09-12T10:05:31.398Z" title="发表于 2020-09-12 18:05:31">2020-09-12</time></span></div><div class="content">Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.
Quick StartCreate a new post1$ hexo new &quot;My New Post&quot;

More info: Writing
Run server1$ hexo server

More info: Server
Generate static files1$ hexo generate

More info: Generating
Deploy to remote sites1$ hexo deploy

More info: Deployment
</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/06/20/03_%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/02_SMB%20v3_RCE_POC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" title="SMBGhost CVE-2020-0796RCE分析">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@V2.0/ImgFromBlog/03_漏洞分析/02_SMBv3_RCE_POC分析报告/SMBGhost.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="SMBGhost CVE-2020-0796RCE分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/06/20/03_%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/02_SMB%20v3_RCE_POC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" title="SMBGhost CVE-2020-0796RCE分析">SMBGhost CVE-2020-0796RCE分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-06-20T12:00:00.000Z" title="发表于 2020-06-20 20:00:00">2020-06-20</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">漏洞分析</a></span></div><div class="content">2020年3月12日，微软官方纰漏了SMB V3（CVE-202-0796）漏洞，并表示该漏洞存在远程代码执行的可能。在4月份就有人证明并演示了如何利用该漏洞进行远程代码执行。而在2020年6月2日，国外安全研究员便将远程代码执行的POC公开了，使得漏洞利用风险骤然升级。本文章便结合公开的POC来简单的介绍一下如何利用CVE-202-0796来进行远程代码执行的（由于本人能力有限，后续复杂的寻找指令指针寄存器的相关内容仍需进一步分析和研究）</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/04/10/03_%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/01_CVE-2017-11882/" title="CVE-2017-11882漏洞分析及复现">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@1.0/BlogImg/myimg/postimg/CVE-2017-11882.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="CVE-2017-11882漏洞分析及复现"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/04/10/03_%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/01_CVE-2017-11882/" title="CVE-2017-11882漏洞分析及复现">CVE-2017-11882漏洞分析及复现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-04-10T12:00:00.000Z" title="发表于 2020-04-10 20:00:00">2020-04-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">漏洞分析</a></span></div><div class="content">CVE-2017-11882漏洞属于缓冲区溢出类型的漏洞，攻击者可利用此漏洞实现任意代码执行，并且隐蔽性极高。该漏洞通杀目前被广泛使用的Office 2003到2016的所有版本。漏洞产生原因是由于EQNEDT32.EXE(Office自带的公式编辑器)进程在读入包含MathType的ole数据时，再拷贝公式名称（Font Name 数据）时没有对名称长度进行校验，从而导致缓冲区溢出，最终通过覆盖其函数的返回地址，实现任意代码执行的。</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/11/20/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/09_GandCrab%20V5.2%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7/" title="GandCrab V5.2解密工具">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@V2.0/ImgFromBlog/01_样本分析报告/09_GandCrabV5.2解密工具/GandCrab.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="GandCrab V5.2解密工具"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/11/20/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/09_GandCrab%20V5.2%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7/" title="GandCrab V5.2解密工具">GandCrab V5.2解密工具</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-11-20T12:00:00.000Z" title="发表于 2019-11-20 20:00:00">2019-11-20</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/">样本分析报告</a></span></div><div class="content">本文主要写的是针对GandCrab V5.2所完成的解密工具。该修复解密报告主要针对GandCrab v5.2的两个版本进行修复的。在分析GandCrab V5.2时，偶然发现v5.2版本就目前我所发现的有两个不同的版本，修复工作也考虑到两者的差异，进行兼容两者都修复。</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2019/11/10/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/08_Ramnit%E6%84%9F%E6%9F%93%E7%97%85%E6%AF%92/" title="Ramnit感染病毒分析报告">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/postimg/Virus_Win32_Ramnit_A.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="Ramnit感染病毒分析报告"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/11/10/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/08_Ramnit%E6%84%9F%E6%9F%93%E7%97%85%E6%AF%92/" title="Ramnit感染病毒分析报告">Ramnit感染病毒分析报告</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-11-10T12:00:00.000Z" title="发表于 2019-11-10 20:00:00">2019-11-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/">样本分析报告</a></span></div><div class="content">本文主要涵盖对Ramnit家族的3个变种（Ramnit.X，Ramnit.AS和Ramnit.A）的分析以及修复方案。其中Ramnit.X变种和Ramnit.AS变种感染文件的方式与之前分析的06—感染型病毒是一样的，所以本文将以Ramnit.A为主要分析对象来进行说明，并会说明Ramnit.A与Ramnit.X变种和Ramnit.AS变种的不同点。由于本文主要是对Ramnit家族的分析与修复方案，将不会特别细致的阐述每一个点，若想看更加详细的分析或想看Ramnit.X变种和Ramnit.AS变种的详细分析，可看Ramnit感染病毒分析报告02。</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/10/30/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/07_MBR%E6%84%9F%E6%9F%93%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" title="MBR感染病毒分析报告">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@1.0/BlogImg/myimg/postimg/Virus.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="MBR感染病毒分析报告"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/10/30/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/07_MBR%E6%84%9F%E6%9F%93%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" title="MBR感染病毒分析报告">MBR感染病毒分析报告</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-10-30T12:00:00.000Z" title="发表于 2019-10-30 20:00:00">2019-10-30</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/">样本分析报告</a></span></div><div class="content">该样本为MBR感染型病毒，其通过修改原始MBR，从而实现在开机运行操作系统之前，执行修改后的MBR中的指令，其对系统进行了3次Hook，最终再开始时加载其写入的驱动文件来实施攻击。经过分析该样本只针对于XP操作系统进行攻击，攻击手段十分隐蔽，并且攻击十分底层，一般情况下很难发现该恶意样本的恶意源头。</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2019/10/20/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/06_%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" title="挖矿木马分析报告">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@1.0/BlogImg/myimg/postimg/CoinMiner.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="挖矿木马分析报告"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/10/20/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/06_%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" title="挖矿木马分析报告">挖矿木马分析报告</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-10-20T12:00:00.000Z" title="发表于 2019-10-20 20:00:00">2019-10-20</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/">样本分析报告</a></span></div><div class="content">该挖矿木马感染受害主机后，会将自身复制到`%AppData%目录`下，并以svchostx64.exe来命名，从而伪装自身。然后通过创建计划任务来维持该样本运行。样本文件的`.plato节表`中包含了一个开源的矿机`XMRig.exe`，该恶意样本再执行时通过创建自身傀儡进程，将开源矿机`XMRig.exe`注入其中，从而实现利用受害主机资源来进行挖矿。该样本不仅会判断受害主机当前是否处于空闲，还会监控进程。当不空闲时（也就是用户正在执行操作时）或是监控到任务管理器进程时，便结束傀儡进程，终止挖矿，来隐藏自身不被发现。</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/10/10/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/05_%E5%AE%8F%E7%97%85%E6%AF%92_APT/" title="宏病毒_APT分析报告">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@1.0/BlogImg/myimg/postimg/APT.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="宏病毒_APT分析报告"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/10/10/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/05_%E5%AE%8F%E7%97%85%E6%AF%92_APT/" title="宏病毒_APT分析报告">宏病毒_APT分析报告</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-10-10T12:00:00.000Z" title="发表于 2019-10-10 20:00:00">2019-10-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/">样本分析报告</a></span></div><div class="content">该样本最终实现执行一个远控程序，样本通过宏代码访问网址中的JS代码，调用mshta执行JS代码解析出的VBS代码。其中多重混淆，并且全程都是以无文件方式执行的，从指定URL上获取两端PE数据流，通过反射加载来创建傀儡进程执行远控程序，在一定程度上可以逃避杀软的查杀，可见该样本的执行过程十分隐蔽，技术手段高超。</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2019/10/01/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/04_%E5%AE%8F%E7%97%85%E6%AF%92/" title="宏病毒分析报告">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@1.0/BlogImg/myimg/postimg/MALWARE.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="宏病毒分析报告"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/10/01/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/04_%E5%AE%8F%E7%97%85%E6%AF%92/" title="宏病毒分析报告">宏病毒分析报告</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-10-01T12:00:00.000Z" title="发表于 2019-10-01 20:00:00">2019-10-01</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/">样本分析报告</a></span></div><div class="content">该样本通过宏代码，将存储在Excel表中的PE数据，写入DLL文件中，然后加载该DLL文件，执行其函数，最终实现将主机信息发送至远端服务器，并从远端服务器下载文件执行。</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2019/10/01/02_%E6%97%A5%E5%B8%B8%E5%88%86%E6%9E%90%E5%AD%A6%E4%B9%A0/01_CrackMe_1/" title="CrackMe 1">     <img class="post_bg" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@1.0/BlogImg/myimg/postimg/SystemHacked.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="CrackMe 1"></a></div><div class="recent-post-info"><a class="article-title" href="/2019/10/01/02_%E6%97%A5%E5%B8%B8%E5%88%86%E6%9E%90%E5%AD%A6%E4%B9%A0/01_CrackMe_1/" title="CrackMe 1">CrackMe 1</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2019-10-01T12:00:00.000Z" title="发表于 2019-10-01 20:00:00">2019-10-01</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox article-meta__icon"></i><a class="article-meta__categories" href="/categories/%E6%97%A5%E5%B8%B8%E5%88%86%E6%9E%90%E5%AD%A6%E4%B9%A0/">日常分析学习</a></span></div><div class="content">该CrackMe是丹阳哥在第一次考核中出的一题，其中有3个反调试，并根据反调试的检测，结果生成不同的KEY。然后利用生成的KEY与密码进行异或，再拿异或后的结果进行比较。只有检测到没有被调试时，该KEY的值才能与密码异或出的结果，才能比较成功。</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside_content" id="aside_content"><div class="card-widget card-info"><div class="card-content"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/avatar.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/friend_404.gif'" alt="avatar"/><div class="author-info__name">Azha0</div><div class="author-info__description">键盘敲烂，月薪过万!</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length_num">13</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length_num">21</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length_num">3</div></a></div></div><a class="button--animated" id="card-info-btn" href="mailto:A_zha0@163.com"><i class="fas fa-envelope"></i><span>联系我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Azha0" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:A_zha0@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div></div><div class="sticky_layout"><div class="card-widget card-announcement"><div class="card-content"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">今日任务：熬夜（1/1）</div></div></div><div class="card-widget card-recent-post"><div class="card-content"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2020/09/12/hello-world/" title="Hello World"><img src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/homepage.jpg-slim" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="Hello World"/></a><div class="content"><a class="title" href="/2020/09/12/hello-world/" title="Hello World">Hello World</a><time datetime="2020-09-12T10:05:31.398Z" title="发表于 2020-09-12 18:05:31">2020-09-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/06/20/03_%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/02_SMB%20v3_RCE_POC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" title="SMBGhost CVE-2020-0796RCE分析"><img src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@V2.0/ImgFromBlog/03_漏洞分析/02_SMBv3_RCE_POC分析报告/SMBGhost.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="SMBGhost CVE-2020-0796RCE分析"/></a><div class="content"><a class="title" href="/2020/06/20/03_%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/02_SMB%20v3_RCE_POC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" title="SMBGhost CVE-2020-0796RCE分析">SMBGhost CVE-2020-0796RCE分析</a><time datetime="2020-06-20T12:00:00.000Z" title="发表于 2020-06-20 20:00:00">2020-06-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/04/10/03_%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/01_CVE-2017-11882/" title="CVE-2017-11882漏洞分析及复现"><img src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@1.0/BlogImg/myimg/postimg/CVE-2017-11882.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="CVE-2017-11882漏洞分析及复现"/></a><div class="content"><a class="title" href="/2020/04/10/03_%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/01_CVE-2017-11882/" title="CVE-2017-11882漏洞分析及复现">CVE-2017-11882漏洞分析及复现</a><time datetime="2020-04-10T12:00:00.000Z" title="发表于 2020-04-10 20:00:00">2020-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2019/11/20/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/09_GandCrab%20V5.2%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7/" title="GandCrab V5.2解密工具"><img src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@V2.0/ImgFromBlog/01_样本分析报告/09_GandCrabV5.2解密工具/GandCrab.png" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="GandCrab V5.2解密工具"/></a><div class="content"><a class="title" href="/2019/11/20/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/09_GandCrab%20V5.2%E8%A7%A3%E5%AF%86%E5%B7%A5%E5%85%B7/" title="GandCrab V5.2解密工具">GandCrab V5.2解密工具</a><time datetime="2019-11-20T12:00:00.000Z" title="发表于 2019-11-20 20:00:00">2019-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2019/11/10/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/08_Ramnit%E6%84%9F%E6%9F%93%E7%97%85%E6%AF%92/" title="Ramnit感染病毒分析报告"><img src="https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/postimg/Virus_Win32_Ramnit_A.jpg" onerror="this.onerror=null;this.src='https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/404.jpg'" alt="Ramnit感染病毒分析报告"/></a><div class="content"><a class="title" href="/2019/11/10/01_%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/08_Ramnit%E6%84%9F%E6%9F%93%E7%97%85%E6%AF%92/" title="Ramnit感染病毒分析报告">Ramnit感染病毒分析报告</a><time datetime="2019-11-10T12:00:00.000Z" title="发表于 2019-11-10 20:00:00">2019-11-10</time></div></div></div></div></div><div class="card-widget card-categories"><div class="card-content"><div class="item-headline"><i class="fas fa-folder-open"></i><span>分类</span></div><ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%97%A5%E5%B8%B8%E5%88%86%E6%9E%90%E5%AD%A6%E4%B9%A0/"><span class="card-category-list-name">日常分析学习</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/"><span class="card-category-list-name">样本分析报告</span><span class="card-category-list-count">9</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"><span class="card-category-list-name">漏洞分析</span><span class="card-category-list-count">2</span></a></li>
            
            </ul></div></div><div class="card-widget card-tags"><div class="card-content"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/Net/" style="font-size: 1.1em; color: #999">.Net</a> <a href="/tags/APT/" style="font-size: 1.1em; color: #999">APT</a> <a href="/tags/BootKit/" style="font-size: 1.1em; color: #999">BootKit</a> <a href="/tags/CrackMe/" style="font-size: 1.1em; color: #999">CrackMe</a> <a href="/tags/Downloader/" style="font-size: 1.1em; color: #999">Downloader</a> <a href="/tags/GandCrab/" style="font-size: 1.1em; color: #999">GandCrab</a> <a href="/tags/Ramnit/" style="font-size: 1.1em; color: #999">Ramnit</a> <a href="/tags/Virus/" style="font-size: 1.1em; color: #999">Virus</a> <a href="/tags/XMRig%E7%9F%BF%E6%9C%BA/" style="font-size: 1.1em; color: #999">XMRig矿机</a> <a href="/tags/%E4%B8%B9%E9%98%B3%E5%93%A5/" style="font-size: 1.1em; color: #999">丹阳哥</a> <a href="/tags/%E4%BF%AE%E5%A4%8D%E5%B7%A5%E5%85%B7/" style="font-size: 1.1em; color: #999">修复工具</a> <a href="/tags/%E5%8B%92%E7%B4%A2/" style="font-size: 1.2em; color: #999da3">勒索</a> <a href="/tags/%E5%A5%87%E5%85%B5%E8%AE%A1%E5%88%92/" style="font-size: 1.4em; color: #99a5b6">奇兵计划</a> <a href="/tags/%E5%AE%8F%E7%97%85%E6%AF%92/" style="font-size: 1.2em; color: #999da3">宏病毒</a> <a href="/tags/%E6%8C%96%E7%9F%BF/" style="font-size: 1.1em; color: #999">挖矿</a> <a href="/tags/%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E6%8A%A5%E5%91%8A/" style="font-size: 1.5em; color: #99a9bf">样本分析报告</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" style="font-size: 1.2em; color: #999da3">漏洞分析</a> <a href="/tags/%E8%A0%95%E8%99%AB/" style="font-size: 1.2em; color: #999da3">蠕虫</a> <a href="/tags/%E8%BF%9C%E6%8E%A7/" style="font-size: 1.3em; color: #99a1ac">远控</a> <a href="/tags/%E8%BF%9C%E6%8E%A7%E6%9C%A8%E9%A9%AC/" style="font-size: 1.1em; color: #999">远控木马</a> <a href="/tags/%E9%9D%9EPE%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80%E6%A0%B7%E6%9C%AC/" style="font-size: 1.2em; color: #999da3">非PE脚本语言样本</a></div></div></div><div class="card-widget card-archives"><div class="card-content"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/09/"><span class="card-archive-list-date">九月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/06/"><span class="card-archive-list-date">六月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/04/"><span class="card-archive-list-date">四月 2020</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/11/"><span class="card-archive-list-date">十一月 2019</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/10/"><span class="card-archive-list-date">十月 2019</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/09/"><span class="card-archive-list-date">九月 2019</span><span class="card-archive-list-count">3</span></a></li></ul></div></div><div class="card-widget card-webinfo"><div class="card-content"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">13</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2020-09-11T16:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">38.5k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2020-09-13T17:27:05.817Z"></div></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/Azha0/ImgHosting@master/BlogImg/myimg/homepage.jpg-slim)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By Azha0</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a target="_blank" rel="noopener" href="https://Azha0.github.io">blog</a>!</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    var typed = new Typed("#subtitle", {
      strings: "Welcome to my Blog!,Life Oriented Programming,键盘敲烂，月薪过万~,今日任务：熬夜（1/1）,996，ICU!,生于码代码，死于解BUG,0 errors，0 warnings!,Talk is cheap，show me your code!".split(","),
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'Welcome to my Blog!'
  }
}

if (true) {
  if (typeof Typed === 'function') subtitleType()
  else $.getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js', subtitleType)
} else {
  subtitleType()
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>